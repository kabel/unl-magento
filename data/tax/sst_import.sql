TRUNCATE TABLE `boundaries`;
LOAD DATA INFILE 'NEB.txt' 
  INTO TABLE `boundaries` 
  FIELDS TERMINATED BY ','
  LINES TERMINATED BY '\r\n'
  (
    record_type,
    begin_date,
    end_date,
    low_address_range,
    high_address_range,
    odd_even_indicator,
    street_pre_directional,
    street_name,
    street_suffix_abbr,
    street_post_directional,
    address_secondary_abbr,
    address_secondary_low,
    address_secondary_high,
    address_secondary_odd_even,
    city_name,
    @zip_code,
    @plus_4,
    @zip_code_low,
    @zip_ext_low,
    @zip_code_high,
    @zip_ext_high,
    composite_ser_code,
    fips_state_code,
    fips_state_indicator,
    fips_county_code,
    fips_place_number,
    fips_place_class_code,
    @longitude,
    @latitude,
    special_tax_district_code_src_1,
    special_tax_district_code_1,
    tax_auth_type_code_1,
    special_tax_district_code_src_2,
    special_tax_district_code_2,
    tax_auth_type_code_2,
    special_tax_district_code_src_3,
    special_tax_district_code_3,
    tax_auth_type_code_3,
    special_tax_district_code_src_4,
    special_tax_district_code_4,
    tax_auth_type_code_4,
    special_tax_district_code_src_5,
    special_tax_district_code_5,
    tax_auth_type_code_5,
    special_tax_district_code_src_6,
    special_tax_district_code_6,
    tax_auth_type_code_6,
    special_tax_district_code_src_7,
    special_tax_district_code_7,
    tax_auth_type_code_7,
    special_tax_district_code_src_8,
    special_tax_district_code_8,
    tax_auth_type_code_8,
    special_tax_district_code_src_9,
    special_tax_district_code_9,
    tax_auth_type_code_9,
    special_tax_district_code_src_10,
    special_tax_district_code_10,
    tax_auth_type_code_10,
    special_tax_district_code_src_11,
    special_tax_district_code_11,
    tax_auth_type_code_11,
    special_tax_district_code_src_12,
    special_tax_district_code_12,
    tax_auth_type_code_12,
    special_tax_district_code_src_13,
    special_tax_district_code_13,
    tax_auth_type_code_13,
    special_tax_district_code_src_14,
    special_tax_district_code_14,
    tax_auth_type_code_14,
    special_tax_district_code_src_15,
    special_tax_district_code_15,
    tax_auth_type_code_15,
    special_tax_district_code_src_16,
    special_tax_district_code_16,
    tax_auth_type_code_16,
    special_tax_district_code_src_17,
    special_tax_district_code_17,
    tax_auth_type_code_17,
    special_tax_district_code_src_18,
    special_tax_district_code_18,
    tax_auth_type_code_18,
    special_tax_district_code_src_19,
    special_tax_district_code_19,
    tax_auth_type_code_19,
    special_tax_district_code_src_20,
    special_tax_district_code_20,
    tax_auth_type_code_20
  )
  SET 
    zip_code = NULLIF(@zip_code, ''),
    plus_4 = NULLIF(@plus_4, ''),
    zip_code_low = NULLIF(@zip_code_low, ''),
    zip_ext_low = NULLIF(@zip_ext_low, ''),
    zip_code_high = NULLIF(@zip_code_high, ''),
    zip_ext_high = NULLIF(@zip_ext_high, ''),
    longitude = NULLIF(@longitude, ''),
    latitude = NULLIF(@latitude, '')
;

TRUNCATE TABLE `rates`;
LOAD DATA INFILE '/Users/kabel/Public/NER.csv' 
  INTO TABLE `rates` 
  FIELDS TERMINATED BY ',' 
  LINES TERMINATED BY '\r\n'
  (
    state, 
    jurisdiction_type,
    jurisdiction_fips_code,
    general_tax_rate_intra,
    general_tax_rate_inter,
    food_drug_tax_rate_intra,
    food_drug_tax_rate_inter,
    begin_date,
    @end_date
  )
  SET end_date = SUBSTRING_INDEX(@end_date, ' ', 1)
;